\documentclass{beamer}
\usepackage[T2A]{fontenc}
\usepackage[all]{xy}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{hyphenat}
\usepackage[T2A,T1]{fontenc}
\usepackage{amsmath}
\usepackage{graphicx}

\usetheme{Madrid}

\title{Сети и потоки. Алгоритм Диница}

\author{~Кононов Николай}

\institute[СПБГУ]
{
    Математико-Механический факультет СПбГУ
}
\date{2019}

\AtBeginSubsection[]
{
  \begin{frame}<beamer>{План}
    \tableofcontents[currentsection,currentsubsection]
  \end{frame}
}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{План}
  \tableofcontents
\end{frame}


\section{Сети и потоки}

\subsection{Простейшие понятия}

\begin{frame}{Сеть}
  \begin{itemize}
  \item {
    \textbf{Определение: } Пусть есть множество вершин V, в котором выделены две вершины: s (вход или исток) и t (выход или сток). \\Пусть определена функция $c:V \times V \rightarrow \mathbb{R}$, удовлетворяющая соотношениям $$\forall x, y \in V \quad c(x, y) \geq 0, c(x, s) = 0, c(t, y) = 0 $$
    Тогда $ G = (V, s, t, c) $ - сеть, функция $c$ - пропускная способность.
    \pause
  }
  \item {
    $A(G) = {(x, y) : c(x, y) > 0}$ - множество стрелок сети $G$
  }
  \end{itemize}
\end{frame}

% You can reveal the parts of a slide one at a time
% with the \pause command:
\begin{frame}{Поток в сети}
  \begin{itemize}
  \item {
    \textbf{Определение: } Пусть $G - $ сеть, а функция $f:V \times V \rightarrow \mathbb{R}$ удовлетворяет трем условиям:\\
        1) $\forall x, y \in V \quad f(x, y) \leq c(x, y)$\\
        2) $\forall x, y \in V \quad f(x, y) = -f(y, x)$\\
        3) $\forall v \in V\textbackslash{t, q}$ выполняется условие: $$ \sum\limits_{v \in V} f(v, x) = 0$$
    \\ $f$ - \textbf{поток в сети $G$}
    \pause
  }
  \item {
    $ |f| = \sum\limits_{v \in V} f(s, v)$ - величина потока\\
        Поток с максимальной величиной - \textbf{максимальный}
  }
  \end{itemize}
\end{frame}

\begin{frame}{Разрез сети}
  \begin{itemize}
    \item {
        \textbf{Определение: } пусть $G$ - сеть, а множество ее вершин $V$ разбито на два дизъюнктых множества $S \ni s$ и $T \ni t$. Тогда $(S,T)$ - разрез сети G
        \pause
    }
    \item {
        Величина $c(S, T) =  \sum\limits_{x \in S, y \in T} c(x, y)$ называется \emph{пропускной способностью разреза}. \\ Любой разрез сети G с минимальной пропускной способностью называется \emph{минимальным}.
    }
    \item {
        Для любого потока f величина $f(S, T) =  \sum\limits_{x \in S, y \in T} f(x, y)$ называется \emph{потоком через разрез}.
        \pause
    }
    \end{itemize}
    \begin{block}{Лемма}
        \textbf{Лемма: } Для любого потока $f$, и разреза $(S, T)$ сети $G$ выполняется $|f| = f(S, T)$
    \end{block}
\end{frame}

\subsection{Остаточная сеть, блокирующий поток, слоистая сеть}

\begin{frame}{Остаточная сеть}
    \begin{exampleblock}{Определение}
        \textbf{Остаточной сетью} $G_{f}$ по отношению к сети $G$ и потоку $f$ в ней называется сеть, в которой каждому ребру $(u, v) \in G$ с пропускной способностью $c^{uv}$ и потоком $f^{uv}$ соответствует два ребра: \\
            1) $(u, v)$ с пропускной способностью $c_{f}^{uv} = c^{uv} - f^{uv}$\\
            2) $(v, u)$ с пропускной способностью $c_{f}^{vu} = f^{uv}$
    \end{exampleblock}
    \pause
    \begin{exampleblock}{Еще одно определение}
        \textbf{Остаточной сетью} $G_{f}$ по отношению к сети $G = \{(V, E), s, t, c\}$ и потоку $f$ в ней называется сеть $G_{f} = \{(V, E), s, t, c_{f}\}$, где 
        \begin{equation*}
        c_{f}(x, y) = 
         \begin{cases}
           0 &\text{if y = s or x = t}\\
           c(x, y) - f(x, y) &\text{otherwise}
         \end{cases}
        \end{equation*}
        то есть, если $(x, y) \not \in E \rightarrow c_f(x, y) = c(x, y) = 0$
    \end{exampleblock}
\end{frame}

\begin{frame}{Остаточная сеть}
Остаточное ребро можно интуитивно понимать как меру того, насколько еще можно увеличить поток вдоль какого-то ребра:\\ если по ребру $(u, v)$ с пропускной способностью $c_{uv}$ протекает поток $f_{uv}$, то по нему можно пустить еще $c_{uv} - f_{uv}$ единиц потока, а в обратную сторону до $f_{uv}$ единиц потока.
\begin{exampleblock}{Определение}
Простой st-путь в $G_{f}$ называется \textbf{дополняющим путем}
\end{exampleblock}
\end{frame}

\begin{frame}{Блокирующий поток. Теорема Форда-Фалкерсона}
    \begin{exampleblock}{Определение}
        \textbf{Блокирующим потоком $f$} в сети $G = (V, s, t, c)$ называется такой поток, что $\forall st$-путь содержит насыщенное этим потоком ребро. То есть в данной сети любой путь из истока в сток нельзя беспрепятственно увеличить.
    \end{exampleblock}
    \pause
    \begin{theorem}
        \textbf{Ford-Fulkerson:} В сети $G$ с пропускной способностью $c$ задан поток $f$, тогда \textit{следующие три утверждения равносильны:\\
        1) Поток f максимален\\
        2) $\exists (S, T)$ такой, что $|f| = c(S, T)$\\
        3) В остаточной сети $G_f$ нет дополняющего пути
        }
    \end{theorem}
    \begin{itemize}
        \item \textbf{Замечание: } блокирующий поток не всегда максимален
    \end{itemize}
\end{frame}

\begin{frame}{Слоистая сеть}
\textbf{Слоистая сеть(layered network, вспомогательная сеть)} строится след образом:
    \begin{itemize}
        \item {
            Для каждой вершины $v$ данной сети $G$ определим длину кратчайшего $s \rightsquigearrow v$-пути из истока и обозначим ее \texttt{d[v]} (можно сделать обходом в ширину)
        }
        \item {
            В слоистую сеть включаем только стрелки $(u, v)$ такие, что \texttt{d[u] = d[v] + 1}
        }
        \item {
            То есть исключим из $G$ стрелки лежащие внутри одного уровня или идущие назад
        }
        \item {
            Получившаяся сеть ациклична и любой $s \rightsquigearrow t$ путь в слоистой сети является кратчайшим путем в исходной сети из свойств \textbf{BFS}
        }
        \item {
         $ G = \{\{1, 2\}, \{3\}, \{4\}, \{2, 5\}, \{3, 5\}, \{1, 6\}\}; \quad s = 0, t = 6$
         \\тогда \textbf{слоистая сеть $G_{s}$} =          $\{\{1, 2\}, \{3\}, \{4\}, \{5\}, \{5\}, \{6\}\}$
         }
    \end{itemize}
\end{frame}

\section{Алгоритм Диница}

\subsection{Основные идеи}

\begin{frame}{Алгоритм Диница. Основные идеи}
    \begin{block}{Постановка задачи}
    Пусть дана сеть $G = (V, s, t, c)$. Как найти поток $f$ из $s$ в $t$ максимальной величины?
    \end{block}
    \begin{itemize}
        \item {
        Алгоритм является улучшенной версией \textbf{Алгоритма Эдмонса-Карпа}
        \pause
        }
        \item {
        Изначально пусть $f(e) = 0 \quad \forall e \in E$
        \pause
        }
        \item {
        Алгоритм состоит из нескольких \textbf{фаз}.
        \pause
        }
        \item {
        На каждой фазе строится остаточная сеть \textbf{$G_f$}, затем по отношению к $G_f$ строится слоистая сеть $G_{L}$(\textbf{BFS}). 
        
        Если \texttt{d[v] = $\infty$} останавливаемся и выводим $f$
        \pause
        }
        \item {
        В построенной слоистой сети находим блокирующий поток $f`$ (любой)
        \pause
        }
        \item {
        Дополняем поток $f$ потоком $f`$ и переходим к следующей фазе
        }
    \end{itemize}
\end{frame}

\subsection{Корректность}
\begin{frame}{Корректность алгоритма}
    \begin{theorem}
        Если алгоритм завершается, полученный поток является потоком максимальной длины.
    \end{theorem}
    \pause
    \begin{proof}
        Предположим, что в какой-то момент в слоистой сети $G_{L}$ построенной для остаточной сети $G_f$ не удалось найти блокирующий поток.\\
        \pause
        Это означает, что $\texttt{d[t] = } \infty$, то есть сток $t$ не достижим из истока $s$ в слоистой сети.\\
        \pause
        Но слоистая сеть содержит в себе все кратчайшие пути в сети $G_{f}$ из истока $s$.\\
        \pause
        Таким образом в остаточной сети нет 
        $s \rightsquigarrow t$ пути\\
        \pause
        Применяя теорему Форда-Фалкерсона получаем, что текущий поток в самом деле максимален.
    \end{proof}
\end{frame}

\subsection{Асимптотика и оценка числа фаз}
\begin{frame}{Оценка числа фаз}
    \begin{theorem}
        Расстояние между истоком и стоком строго увеличивается после каждой фазы алгоритма:
        \texttt{d_{n}[t] > d_{n-1}[t] }
    \end{theorem}
    
    \begin{proof}
        От противного. Пусть длина кратчайшего $s \rightsquigarrow t$ пути останется неизменной после очередной фазы алгоритма.
    \end{proof}
\end{frame}

% Placing a * after \section means it will not show in the
% outline or table of contents.
\section*{Summary}

\begin{frame}{Summary}
  \begin{itemize}
  \item
    he \alert{first main message} of your talk in one or two lines.
  \item
    The \alert{second main message} of your talk in one or two lines.
  \item
    Perhaps a \alert{third message}, but not more than that.
  \end{itemize}

  \begin{itemize}
  \item
    Outlook
    \begin{itemize}
    \item
      Something you haven't solved.
    \item
      Something else you haven't solved.
    \end{itemize}
  \end{itemize}
\end{frame}



% All of the following is optional and typically not needed.
\appendix
\section<presentation>*{\appendixname}
\subsection<presentation>*{For Further Reading}

\begin{frame}[allowframebreaks]
  \frametitle<presentation>{For Further Reading}

  \begin{thebibliography}{10}

  \beamertemplatebookbibitems
  % Start with overview books.

  \bibitem{Author1990}
    A.~Author.
    \newblock {\em Handbook of Everything}.
    \newblock Some Press, 1990.


  \beamertemplatearticlebibitems
  % Followed by interesting articles. Keep the list short.

  \bibitem{Someone2000}
    S.~Someone.
    \newblock On this and that.
    \newblock {\em Journal of This and That}, 2(1):50--100,
    2000.
  \end{thebibliography}
\end{frame}

\end{document}
The \alert{first main message} of your talk in one or two lines.
  \item
    The \alert{second main message} of your talk in one or two lines.
  \item
    Perhaps a \alert{third message}, but not more than that.
  \end{itemize}

  \begin{itemize}
  \item
    Outlook
    \begin{itemize}
    \item
      Something you haven't solved.
    \item
      Something else you haven't solved.
    \end{itemize}
  \end{itemize}
\end{frame}



% All of the following is optional and typically not needed.
\appendix
\section<presentation>*{\appendixname}
\subsection<presentation>*{For Further Reading}

\begin{frame}[allowframebreaks]
  \frametitle<presentation>{For Further Reading}

  \begin{thebibliography}{10}

  \beamertemplatebookbibitems
  % Start with overview books.

  \bibitem{Author1990}
    A.~Author.
    \newblock {\em Handbook of Everything}.
    \newblock Some Press, 1990.


  \beamertemplatearticlebibitems
  % Followed by interesting articles. Keep the list short.

  \bibitem{Someone2000}
    S.~Someone.
    \newblock On this and that.
    \newblock {\em Journal of This and That}, 2(1):50--100,
    2000.
  \end{thebibliography}
\end{frame}

\end{document}
